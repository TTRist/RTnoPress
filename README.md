# RTnoPullHand
陳列ロボットの棚引き出し機構用のArduinoファイル．
2020/12/23現在はArduino Unoにて動作させている．

## 使い方
RTCの『RTnoPullHandTester』からの指令によって動作する．

#### 指令1：引き出し作業
（棚を拾って引き出す動作）．作業終了時に1を返す．
#### 指令2：棚を戻す作業
（引き出してある棚を押し戻し，機構をしまう動作）．作業終了時に2を返す．
#### 指令3：引き出し作業（ストローク短い版 21/08/23追記）
（棚を拾って引き出す動作）．作業終了時に1を返す．陳列棚什器のトリガーが外れないように引くときに使用．
#### 指令101：棚を拾うだけの動作
#### 指令102：引き出すだけの動作
#### 指令103：棚を押し出すだけの動作
#### 指令104：機構をしまうだけの動作
#### 指令105：機構を押し出すだけの動作（ストローク短い版 21/08/23追記）

前まで使用していたコードとは異なり，onExecute関数を常にループし続けるようになった．

### 速度などを調整する場合
define.h内で変更できる．
"MOTOR_SPEED"と"SLOW_DOWN_DISTANCE"を調整する必要がある．
"MOTOR_SPEED"を上げたなら，減速が追い付かなくなるので，"SLOW_DOWN_DISTANCE"も大きくする．


## 非常停止機能
ソフトウェアによる非常停止．stopByEMS()関数にて『EMS_in0』というポートを監視し，停止かどうかを受け取る．
ポートにコンポーネントを繋げなくてもロボットは動くが，ソフト的に非常停止しなくなる．

## その他
### DCMotor.hについて
単純なモタドラ(DIR,PWM,SLPがあるやつ)でDCモータを動かすライブラリ．
現在はカレントディレクトリからの引用だが，Arduinoのライブラリフォルダに入れてもOK．

### エラー「Unknown Packet:K」が出る場合
RTnoProxyにて「Unknown Packet:K」が発生する場合は，ArduinoライブラリのRTno.cpp内にて，
『timeout = 20 * 1000』(20ms)を『timeout = 3600 * 1000 * 1000』に変えておくこと．
